<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Redirecting…</title>

  <style>
    :root { color-scheme: light dark; }
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;
      background: #0b1220; color:#e8eefc;
    }
    .card{
      width:min(720px, 92vw);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 22px 20px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    h1{ margin:0 0 10px; font-size:18px; }
    p{ margin:8px 0; opacity:.9; line-height:1.5; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: 12.5px; opacity:.85; word-break: break-all; }
    a{
      color:#9bd1ff; text-decoration:none;
      border-bottom:1px dashed rgba(155,209,255,.6);
    }
    .spinner{
      width:18px; height:18px; border-radius:50%;
      border:2px solid rgba(255,255,255,.25);
      border-top-color: rgba(255,255,255,.9);
      display:inline-block; vertical-align:-3px;
      animation: spin .8s linear infinite;
      margin-right:8px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .btn{
      display:inline-block; padding:10px 12px; border-radius:12px;
      background: rgba(155,209,255,.16);
      border: 1px solid rgba(155,209,255,.28);
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="row">
      <span class="spinner" aria-hidden="true"></span>
      <h1>กำลังพาไปยัง dooPRO…</h1>
    </div>

    <p id="status">กำลังเตรียมลิงก์ปลายทาง</p>

    <p class="mono">Source: <span id="src"></span></p>
    <p class="mono">Target: <span id="dst"></span></p>

    <p id="fallback" style="display:none;">
      ถ้าไม่เด้งอัตโนมัติ ให้คลิก: <a id="link" class="btn" href="#">ไปต่อ</a>
    </p>
  </div>

  <script>
    (function () {
      const srcEl = document.getElementById("src");
      const dstEl = document.getElementById("dst");
      const statusEl = document.getElementById("status");
      const fallbackEl = document.getElementById("fallback");
      const linkEl = document.getElementById("link");

      srcEl.textContent = window.location.href;

      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");

      // ปลายทางคงที่ + เอา id ไปต่อท้ายเป็น path segment
      const base = "https://doopro-v3.glide.page/dl/c94c5f/s/cbd972/r/";

      if (!id) {
        statusEl.textContent = "ไม่พบพารามิเตอร์ id ในลิงก์นี้";
        const home = "https://doopro-v3.glide.page/";
        dstEl.textContent = home;
        linkEl.href = home;
        linkEl.textContent = "ไปหน้า dooPRO";
        fallbackEl.style.display = "";
        return;
      }

      const target = base + encodeURIComponent(id);
      dstEl.textContent = target;
      linkEl.href = target;
      linkEl.textContent = "ไปต่อ";

      statusEl.textContent = "กำลัง Redirect…";

      // ใช้ replace เพื่อไม่ทิ้ง history หน้าก่อนหน้า
      window.location.replace(target);
    })();
  </script>
</body>
</html>
