<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Redirect</title>
  <style>
    :root { color-scheme: light dark; }
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      background:#0b1220;
    }
    .wrap{
      width:min(520px, 88vw);
      display:flex; flex-direction:column; align-items:center;
      gap:18px;
    }
    img{
      width:96px; height:96px; object-fit:contain;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
      user-select:none; -webkit-user-drag:none;
    }
    .bar{
      width:100%;
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.14);
      overflow:hidden;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.10);
    }
    .bar > i{
      display:block;
      width:0%;
      height:100%;
      border-radius:999px;
      background: rgba(255,255,255,.9);
      transform-origin:left center;
      transition: width 0.06s linear;
    }
  </style>
</head>
<body>
  <div class="wrap" aria-label="redirecting">
    <img
      src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/9f84wP1Z15DFbydzU3Zk/pub/1UQA2d7YyvW8VhzNxZma.png"
      alt=""
    />
    <div class="bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
      <i id="fill"></i>
    </div>
  </div>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      const base = "https://doopro-v3.glide.page/dl/c94c5f/s/cbd972/r/";
      const target = base + encodeURIComponent(id || "");

      const fill = document.getElementById("fill");
      const bar = document.querySelector(".bar");

      // ระยะเวลาแอนิเมชัน (ms) — ปรับได้ตามชอบ
      const DURATION = 900;

      const t0 = performance.now();
      function tick(now) {
        const t = Math.min(1, (now - t0) / DURATION);
        const pct = Math.round(t * 100);

        fill.style.width = pct + "%";
        bar.setAttribute("aria-valuenow", String(pct));

        if (t < 1) {
          requestAnimationFrame(tick);
        } else {
          // redirect หลัง progress ถึง 100%
          window.location.replace(target || "https://doopro-v3.glide.page/");
        }
      }

      requestAnimationFrame(tick);
    })();
  </script>
</body>
</html>
